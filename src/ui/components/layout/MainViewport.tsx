import React, { useState } from 'react';
import styles from './MainViewport.module.css';
import NarrativeBox from '../narrative/NarrativeBox';
import PlayerInputField from '../actions/PlayerInputField';

interface MainViewportProps {
    className?: string;
}

import { useGameState } from '../../hooks/useGameState';

const MainViewport: React.FC<MainViewportProps> = ({ className }) => {
    const { state, processCommand } = useGameState();

    const narrativeText = state?.storySummary ||
        "Welcome to your adventure. Describe your first move...";

    const locationTitle = state ?
        `Coordinates: [${state.location.coordinates.join(', ')}]` :
        "Starting Location";

    // Placeholder actions if none generated by LLM yet
    const suggestedActions = [
        "Look around",
        "Check gear",
        "Move North",
        "Rest"
    ];

    const handlePlayerInput = (input: string) => {
        processCommand(input);
    };

    return (
        <main className={`${styles.viewport} ${className}`}>
            <div className={styles.narrativeContainer}>
                <NarrativeBox
                    title={locationTitle}
                    text={narrativeText}
                />
            </div>
            <div className={styles.actionBar}>
                <PlayerInputField
                    suggestedActions={suggestedActions}
                    onSubmit={handlePlayerInput}
                />
            </div>
        </main>
    );
};

export default MainViewport;
